<div class="ui secondary menu no-margin ">
  {{#if refreshButton}}
    <button class="ui {{buttonClass}} button" {{action "refresh"}}>
      {{t "components.olv-toolbar.refresh-button-text"}}
    </button>
  {{/if}}
  {{#if createNewButton}}
    <button class="ui {{buttonClass}} {{if enableCreateNewButton "" "disabled"}} button" {{action "createNew"}}>
      {{t "components.olv-toolbar.add-button-text"}}
    </button>
  {{/if}}
  {{#if deleteButton}}
    <button class="ui {{buttonClass}} {{if isDeleteButtonEnabled "" "disabled"}} button" {{action "delete"}}>
      {{t "components.olv-toolbar.delete-button-text"}}
    </button>
  {{/if}}
  {{#if availableHierarchicalMode}}
    <button class="ui button icon {{buttonClass}} {{if inHierarchicalMode "active"}}" {{action "switchHierarchicalMode"}}>
      <i class="sitemap icon"></i>
    </button>
  {{/if}}
  {{#if enableFilters}}
    <div class="ui icon input buttons">
      <button class="ui button {{buttonClass}} {{if showFilters "active"}}" {{action "toggleStateFilters"}}>
        <i class="filter icon"></i>
      </button>
      {{#if filters}}
        <div class="or" data-text="&bull;"></div>
        <button class="ui button {{buttonClass}}" {{action "resetFilters"}}>
          <i class="remove icon"></i>
        </button>
      {{/if}}
    </div>
  {{/if}}
  {{#if filterButton}}
    <div class="ui action input">
      {{input
        type="text"
        placeholder=(t "components.olv-toolbar.filter-by-any-match-placeholder")
        value=filterByAnyMatchText enter="filterByAnyMatch"
      }}
      <button class="ui {{buttonClass}} icon button" {{action "filterByAnyMatch"}}>
        <i class="search icon"></i>
      </button>
      <button class="ui {{buttonClass}} icon button" {{action "removeFilter"}}>
        <i class="remove icon"></i>
      </button>
    </div>
  {{/if}}
  {{#if colsConfigButton}}
    <div class="ui buttons">
      <button class="ui icon button" {{action "showConfigDialog"}}>
        <i class="large table icon"></i>
      </button>
      {{#if colsSettingsItems}}
        {{flexberry-menu
          items=colsSettingsItems
          onItemClick=(action "onMenuItemClick")
        }}
      {{/if}}
    </div>
  {{/if}}
  {{#each customButtons as |customButton|}}
    <button
      class="ui {{if customButton.buttonClasses customButton.buttonClasses ""}} button"
      {{action "customButtonAction" customButton.buttonAction}}>
      {{if customButton.buttonName customButton.buttonName (t "components.olv-toolbar.custom-button-text")}}
    </button>
  {{/each}}
  <div class="olv-toolbar-info-modal-dialog ui small basic modal">
    <div class="ui icon header">
      <i class="olvt icon"></i>
      {{_infoModalDialogCaption}}
    </div>
    <div class="center aligned ui grid">
    <button class="ui icon button" {{action "copyJSONContent"}} id='OLVToolbarInfoCopyButton'>
        <i class="copy icon"></i>
        {{t "components.olv-toolbar.copy"}}
      </button>
      <div class="actions">
      <div class="olv-toolbar-info-modal-dialog-ok-button ui approve green inverted button" >
          <i class="remove icon"></i>
          {{t "components.olv-toolbar.close"}}
        </div>
      </div>
    </div>
    <div class="ui form">
      <div class="olv-toolbar-info-modal-dialog-content center aligned ui field">
        <textarea id='OLVToolbarInfoContent' cols='80' rows='20'>{{_infoModalDialogContent}}</textarea>
      </div>
    </div>
  </div>
</div>

<div class="object-list-view-container">
  {{#if errorMessages}}
    {{#each errorMessages as |currentError|}}
      {{ui-message
        type='error'
        closeable=true
        visible=true
        title='Error occurred'
        message=currentError
      }}
    {{/each}}
  {{/if}}
  <table class="object-list-view ui unstackable celled {{if readonly 'readonly'}} {{tableClass}} table">
    <thead>
      <tr>
        {{#if showHelperColumn}}
          <th class="object-list-view-operations collapsing {{unless showHelperColumn 'hidden'}}" data-olv-header-property-name="OlvRowToolbar"></th>
        {{/if}}
        {{#each columns as |column|}}
          {{#unless column.hide}}
            <th class="dt-head-left me class" onclick={{ action "headerCellClick" column }}>
              <div data-olv-header-property-name={{column.propName}} title={{t "components.object-list-view.header-title-attr"}}>
                <span>
                {{#if column.keyLocale}}
                  {{t column.keyLocale}}
                {{else}}
                  {{column.header}}
                {{/if}}
                </span>
                {{#if column.sorted}}
                  <div style="float:right;">
                    {{#if column.sortAscending}}
                      <div title="Order ascending">
                      ▲{{column.sortNumber}}
                      </div>
                    {{else}}
                      <div title="Order descending">
                      ▼{{column.sortNumber}}
                      </div>
                    {{/if}}
                  </div>
                {{/if}}
              </div>
            </th>
          {{/unless}}
        {{/each}}
        {{#if showMenuColumn}}
          <th class="object-list-view-menu collapsing" data-olv-header-property-name="OlvRowMenu"></th>
        {{/if}}
      </tr>
    </thead>
    <tbody class="{{if showLoadingTbodyClass 'ui loading form' ''}}">
      {{#if showFilters}}
        <tr>
          <td rowspan="2" class="{{unless (and showHelperColumn hasContent) 'hidden'}}"></td>
          {{#each columns as |column|}}
            {{#unless column.hide}}
              <td>
                {{#if column.filter.conditions}}
                  {{component "flexberry-dropdown"
                    value=column.filter.condition
                    items=column.filter.conditions
                    class="compact fluid"
                    placeholder=""
                    needChecksOnValue=false
                  }}
                {{/if}}
              </td>
            {{/unless}}
          {{/each}}
          {{#if showMenuColumn}}
            <td rowspan="2"></td>
          {{/if}}
        </tr>
        <tr>
          {{#each columns as |column|}}
            {{#unless column.hide}}
              <td>
                {{#if column.filter.component.name}}
                  {{component column.filter.component.name
                    value=column.filter.pattern
                    dynamicProperties=column.filter.component.properties
                  }}
                {{/if}}
              </td>
            {{/unless}}
          {{/each}}
        </tr>
      {{/if}}
      {{#if rowsInLoadingState}}
        <tr>
          <td colspan="{{colspan}}" style="text-align:center;">
            <div class="ui active centered inline loader"></div> {{t "components.object-list-view.loading-text"}}
          </td>
        </tr>
      {{/if}}
      {{#unless content}}
        <tr>
          <td colspan="{{colspan}}" style="text-align:center;">
              {{placeholder}}
          </td>
        </tr>
      {{else}}
        {{#each contentWithKeys key="key" as |record|}}
            <tr class="{{record.rowConfig.customClass}}">
              <td class="object-list-view-helper-column {{unless showHelperColumn "hidden"}}">
                <div class="hidden">{{record.key}}</div>
                {{#if showHelperColumn}}
                  <div class="object-list-view-helper-column-cell">
                    {{#if showAsteriskInRow}}
                      <div class="cell">
                        <i class="asterisk small red icon {{unless record.data.hasDirtyAttributes "transparent"}}"></i>
                      </div>
                    {{/if}}
                    {{#if showCheckBoxInRow}}
                      <div class="cell">
                        {{flexberry-checkbox
                          readonly=(or readonly (not record.rowConfig.canBeSelected))
                          onChange=(action "selectRow" record)
                        }}
                      </div>
                    {{/if}}
                    {{#if showDeleteButtonInRow}}
                      <div class="cell">
                        <button class="ui {{buttonClass}} {{if (or readonly (not record.rowConfig.canBeDeleted)) "disabled"}} button" {{action 'deleteRow' record}}>
                          <i class="minus icon"></i>
                        </button>
                      </div>
                    {{/if}}
                  </div>
                {{/if}}
              </td>
              {{#each columns as |column|}}
                {{#unless column.hide}}
                  <td {{action "objectListViewRowClick" record preventDefault=false}}>
                    {{#if column.cellComponent.componentName}}
                      {{component column.cellComponent.componentName
                        dynamicProperties=column.cellComponent.componentProperties
                        relatedModel=record.data
                        value=(mut (get record.data column.propName))
                        readonly=readonly
                        required=required
                      }}
                    {{else}}
                      <div class="oveflow-text">
                        {{get-formatted record.data column.propName
                          dateFormat=dateFormat
                          moment=moment
                        }}
                      </div>
                    {{/if}}
                  </td>
                {{/unless}}
              {{/each}}
              {{#if showMenuColumn}}
                <td class="object-list-view-menu">
                  <div class="basic right pointing ui icon dropdown button">
                    <i class="list layout icon"></i>
                    <div class="left menu">
                      {{#if record.rowConfig.canBeSelected}}
                        <div class="item" {{ action "objectListViewRowClick" record }}>
                          <i class="edit icon"></i>
                          <span>{{t "components.object-list-view.menu-in-row.edit-menu-item-title"}}</span>
                        </div>
                      {{/if}}
                      {{#if record.rowConfig.canBeDeleted}}
                        <div class="item" {{ action "deleteRow" record }}>
                          <i class="trash icon"></i>
                          <span>{{t "components.object-list-view.menu-in-row.delete-menu-item-title"}}</span>
                        </div>
                      {{/if}}
                    </div>
                  </div>
                </td>
              {{/if}}
            </tr>
        {{/each}}
      {{/unless}}
    </tbody>
  </table>
</div>
<div class="ui secondary menu no-margin">
  <div class="ui basic buttons">
    <button class="ui {{unless hasPreviousPage 'disabled'}} button" {{action 'previousPage' this.attrs.previousPage}}>&laquo;</button>
    {{#each pages as |page|}}
      {{#if page.isEllipsis}}
        <div class="ui button">...</div>
      {{else}}
        {{#if page.isCurrent}}
          <div class="ui active button">{{page.number}}</div>
        {{else}}
          <button class="ui button" {{action 'gotoPage' this.attrs.gotoPage page.number}}>{{page.number}}</button>
        {{/if}}
      {{/if}}
    {{/each}}
    <button class="ui {{unless hasNextPage 'disabled'}} button" {{action 'nextPage' this.attrs.nextPage}} >&raquo;</button>
  </div>
  <div class="right menu">
    {{flexberry-dropdown items=perPageValues value=perPageValue class="compact selection" onChange=(action "perPageClick")}}
  </div>
</div>
{{#if showShowingEntries}}
  <div class="showing-entries">
    {{#if (and currentIntervalRecords recordsTotalCount) }}
      {{concat
        (t "components.flexberry-objectlistview.showing-entries.showing") currentIntervalRecords (t "components.flexberry-objectlistview.showing-entries.of") recordsTotalCount (t "components.flexberry-objectlistview.showing-entries.entries")
      }}
    {{/if}}
  </div>
{{/if}}
